<%
  if @mule.user.photo.attached?
    url = cl_image_path @mule.user.photo.key, height: 300, crop: :fill
  else
    url = 'https://cdnmundo1.img.sputniknews.com/img/108565/78/1085657854_0:555:1500:1367_1000x541_80_0_0_ab86277e9d4cb8f1a28c69f7cd8438f4.jpg'
  end
%>

<div class="container d-flex justify-content-between align-items-center mt-5 pt-5 ml-5">
  <div class="mule-info-card m-5 col-12 col-lg-8" >
    <div class="mule-profile-infos">
      <img src='<%= url %>' class="card-mule-user avatar-bordered" />
      <div class="mule-details">
        <h2><%= @mule.user.username %></h2>
        <p><strong>Commission:</strong> <%= @mule.rate_per_km_per_kg %> €</p>
      </div>
    </div>
    <div class="mule-profile-description p-4 ">
      <p><strong>A bit of me:</strong> <%= @mule.description %></p>
      <p><strong>I do my services by:</strong> <%= @mule.transportation_means %></p>
    </div>
  </div>
  <% unless current_user.mules.include?(@mule) %>
    <div class="mule-info-card m-5 col-lg-4">
      <h2 class="py-3">Make an offer:</h2>
        <%= simple_form_for([@mule, @offer], html: { data: { controller: "offer-update", offer_update_commission_value: @mule.rate_per_km_per_kg } }) do |f|%>
          <%= f.input :destination, input_html: { data: { offer_update_target: "destination", action: "blur->offer-update#computeDistance" } } %>
          <%= f.input :starting_point, input_html: { data: { offer_update_target: "start", action: "blur->offer-update#computeDistance" } } %>
          <%= f.input :drug_type %>
          <%= f.input :weight, input_html: { data: { offer_update_target: "weight", action: "change->offer-update#computeCommission" } } %>

          <div class="d-flex justify-content-center mt-2">  <%= f.submit "Offer 0€", data: { offer_update_target: "submit"} %></div>
        <% end %>
    </div>
  </div>
<% end %>
<div class="back-btn"><%= link_to 'Back', mules_path, class: "btn-login mr-5" %></div>
