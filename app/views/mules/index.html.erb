
<h1 class="title-mules-index text-center m-5">Find the best mule for you</h1>
<div class="d-flex">
  <div class="container col-sm-8 p-2">
    <%= simple_form_for :search, url: root_path, method: :get do |f| %>
      <div class="search-form-control form-group mx-5 mb-5">
        <input class="form-control string required" type="text" name="search[query]" id="search_query" />
        <button name="button" type="submit" class="btn btn-flat">
          <i class="fas fa-search"></i> Search your location
        </button>
      </div>
    <% end %>

    <div class="cards mx-5">
      <% @mules.each do |mule| %>
        <%= link_to mule_path(mule) do %>
        <div class="card-mule">
        <%
          if mule.user.photo.attached?
            url = cl_image_path mule.user.photo.key, height: 300, crop: :fill
          else
            url = 'https://cdnmundo1.img.sputniknews.com/img/108565/78/1085657854_0:555:1500:1367_1000x541_80_0_0_ab86277e9d4cb8f1a28c69f7cd8438f4.jpg'
          end
        %>
          <img src= '<%= url %>' />
          <div class="card-mule-infos">
            <h2> <%= mule.user.username %></h2>
            <p><strong>Location: </strong><%= mule.location %></p>
            <p> <%= mule.description  %></p>
            <p>Rate: <strong><%= mule.rate_per_km_per_kg %> â‚¬</strong></p>
          </div>
        </div>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="col-sm-4 p-3">
    <div id="map"
        style="width: 100%; height: 40rem;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
</div>
